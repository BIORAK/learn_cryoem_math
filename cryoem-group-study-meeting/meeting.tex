\documentclass[11pt, oneside]{article}   	% use "amsart" instead of "article" for AMSLaTeX format
\usepackage{geometry}                		% See geometry.pdf to learn the layout options. There are lots.
\geometry{letterpaper}                   		% ... or a4paper or a5paper or ... 
%\geometry{landscape}                		% Activate for rotated page geometry
%\usepackage[parfill]{parskip}    		% Activate to begin paragraphs with an empty line rather than an indent
\usepackage{graphicx}				% Use pdf, png, jpg, or epsÂ§ with pdflatex; use eps in DVI mode
								% TeX will automatically convert eps --> pdf in pdflatex		
\usepackage{amssymb}
\usepackage{hyperref}
\usepackage{multirow}
\usepackage{ulem}

%SetFonts

%SetFonts


\title{Online CryoEM Study Group}
\author{Geoffrey Woollard, Toronto, Canada}
%\date{}							% Activate to display a given date or no date

\begin{document}
\maketitle

\section{General Information}

Feel free to share this document and direct people to sign up at \url{https://forms.gle/BUeUW14vV4pyQbDDA} so I have the emails in one place. Online meeting links are emailed to those on this list. {\bf Please join the Slack group and ask questions there, rather than emailing me.}

\subsection{Audience and Streams}
Over 2/3 of the audience are grad students. There rest of the audience is a mix of long term staff (facility manager, seniour scientist, research associate, unspecified industry position, etc.), principal investigators (industry or academic), postdocs, and undergraduate. After carefully reading the responses, I think it would be best to have two streams each meeting. I have code named them the {\bf blur} and {\bf sharpen} stream, referring to map sharpening. I am counting on your sense of humour and humility for this playful naming schema! Perhaps its a bit more gentle than low and high resolution? Remember that both blurred and sharpened maps are important for being able to see what is going on and build a model in to the map. The goal of this study group is to have both intuition and be able to connect that back to the math, never missing the forest for the trees.

{\bf  Blur stream}: Beginners and intermediates with may have years of expertise doing sample prep, collecting data on the scope, making maps, and building models. However, many people with such expertise expressed a desire to go deeper into the fundamentals, and understand things better under the hood, and requested help to become more confident in the math. One person put it bluntly, "I am interested in being more than a button pusher."

{\bf Sharpen stream}: This stream can be for people with a high degree of expertise that are looking to sharpen their skills, and interact with other experts. For example: methods developers with perhaps not that much experience processing datasets from start to finish, university instructors, facility managers who have a strong working knowledge but want to go deeper into the foundations and refresh, people with strong math and physics backgrounds that are fairly new but will catch on quickly, experts in crystallography that are switching over to cryoEM but that have a strong theoretical basis in the underlying math already.

After reading through the responses a few times, I would estimate the ratio of the streams to be about 3/4 blur to 1/4 sharpen. In the first meeting you can choose your own stream, and go to breakout rooms with this in mind. I will make multiple breakout rooms so that there can be small group discussion. We can use the {\bf white board and share screen features}. If you are an expert feel free to go to the blur stream and help out. If you judge yourself an intermediate-beginner, you can test the waters in the sharpen stream. The two stream format may evolve over time (e.g. three streams, a lecture with everyone together), but let's try out two streams and see how it goes.

\subsection{Pre-requisites}
This is a sort of lower bound, so that you don't show up and become lost or frustrated, especially in the blur stream.

\subsubsection{Math}
You should be able to hit the ground running if you did alright in first year undergraduate calculus or did a second and third year statistics/physics/chemistry course with a quantitative and computational emphasis. If it's been a while you may want to quickly run through some online videos (khan academy for example) and brush up. You don't have to be strong in pure math (real analysis, proofs)
\begin{enumerate}
	\item calculus (single and multiple integrals, derivatives)
	\item trigonometry (sin, cos, etc.)
	\item linear algebra, 2D and 3D cartesian geometry, vectors, matrices
	\item statistics and probability (expectation, mean/variance, random variables, common distributions like gaussian/uniform/poisson)
	\item summation notation (sigma sums)
\end{enumerate}

Here are some resources from \url{khanacademy.org} for brushing up on your math

\begin{enumerate}
	\item \href{https://www.khanacademy.org/math/differential-calculus/dc-diff-intro}{Unit: Derivatives: definition and basic rules} 
	\item \href{https://www.khanacademy.org/math/differential-calculus/dc-chain}{Unit: Derivatives: chain rule and other advanced topics}
	\item \href{https://www.khanacademy.org/math/integral-calculus/ic-integration} {Unit: Integrals}
	\item \href{https://www.khanacademy.org/math/integral-calculus/ic-series}{Unit: Series}
	\item \href{https://www.khanacademy.org/math/linear-algebra}{Linear Algebra}
	\item \href{https://www.khanacademy.org/math/statistics-probability/probability-library}{Unit: Probability}
	\item \href{https://www.khanacademy.org/math/statistics-probability/counting-permutations-and-combinations}{Unit: Counting, permutations, and combinations}
	\item \href{https://www.khanacademy.org/math/statistics-probability/random-variables-stats-library}{Unit: Random variables}
\end{enumerate}

There is also a great series from \href{https://www.youtube.com/c/3blue1brown}{3Blue1Brown} on \href{https://youtube.com/playlist?list=PLZHQObOWTQDPD3MizzM2xVFitgF8hE_ab}{The Essence of Linear Algebra}, focusing on visual intuition of  linear transformations; and the \href{https://youtube.com/playlist?list=PLZHQObOWTQDMsr9K-rj53DwVRMYO3t5Yr}{Essence of calculus}: "The goal here is to make calculus feel like something that you yourself could have discovered."

\subsubsection{Physics}
\begin{itemize}
	\item Some exposure to modern (20th century) physics in a first or second year undergraduate course (relativity, QM). This comes in especially for the forward model.
	\item Some intuition about what is physically happening in the sample, at room temperature, after vitrification, and during imaging. The 2017 Chemistry Nobel lectures by Henderson, Dubochet and Frank would be more than enough.
\end{itemize}

\subsection{Meeting Format}
We will start with the "flipped classroom" and "breakout room discussions" to get things off the ground with minimal overhead. After some initial meetings we will try out a mix of the following formats listed below, with their surveyed popularity  listed next to them. {\bf If you would like to volunteer to give a lecture or be available for office hours then please volunteer yourself through the Slack channel.}
\begin{itemize}
	\item Lecture with Q\&A
	\item Flipped classroom: i.e. we have a syllabus with pre-reading (textbook chapter, review paper) that we go through before and then discuss online
	\item Breakout room discussion (small groups organized thematically)
	\item Office hours with an expert available to answer questions
\end{itemize}

\section{Dates and Topics}
Given the current distribution of our global audience (90\%+  in North America and Europe), we will have the time at {\bf 9 AM PST, which is 12 PM EST, 5 PM GMT, 7 PM GMT+2, 1 AM next day GMT+8, 3 AM next day GMT+10}. I am open to proposals to occasionally have a different time to accommodate a global audience - especially if the presenter is from a less represented time zone.

\begin{center}
\small
 \begin{tabular}{|| c c c c||} 
 \hline
 Date & Time & Stream & Topic \\ [0.5ex] 
 \hline\hline
Th 19 Nov 2020 & \tiny{9 AM PST} &  blur/sharpen & background math \& defocus phase contrast  \\ 
 \hline
\sout{Th 26 Nov 2020}  &   & & (cancelled for US Thanksgiving )    \\ 
 \hline
Th 3 Dec 2020 & \tiny{9 AM PST} & blur & Fourier transform   \\ 
 \hline
Th 10 Dec 2020 & \tiny{9 AM PST} & sharpen & Fourier transform   \\ 
 \hline
Th 17 Dec 2020 & \tiny{9 AM PST} & blur & convolution, sampling, Nyquist   \\ 
 \hline
Th 7 Jan 2021 & \tiny{9 AM PST} & sharpen & convolution, sampling, Nyquist   \\ 
 \hline
Th 14 Jan 2020 & \tiny{9 AM PST} & blur & phase-contrast in the EM   \\ 
 \hline
Th 21 Jan 2021 & \tiny{9 AM PST} & sharpen & phase-contrast in the EM   \\ 
 \hline
Th 28 Jan 2021 & \tiny{9 AM PST} & blur & image formation (forward model)   \\ 
 \hline
Th 11 Feb 2021 & \tiny{8 AM PST} & sharpen & image formation (forward model), multislice   \\ 
 \hline
Th 18 Feb 2021 & \tiny{8 AM PST} & sharpen &  2D expectation-maximization \\ 
 \hline
Th 25 Feb 2021 & \tiny{8 AM PST} & blur & coordinate systems \& rotations  \\ 
 \hline
 Th 4 March 2021 & \tiny{8 AM PST} & sharpen & coordinate systems \& rotations  \\ 
 \hline
Th 11 March 2021 & \tiny{7:30 AM PST} & blur & interpolation  \\ 
 \hline
 Th 18 March 2021 & \tiny{8 AM PST} & sharpen & interpolation  \\ 
 \hline
Th 25 March 2021 & \tiny{8 AM PST} & blur & \tiny{Guest lecture: TBC D. Dynerman, 3D reconstruction via direct Fourier inversion}  \\ 
 \hline
Th 1 Apr 2021 & \tiny{8 AM PST} & sharpen & \tiny{3D reconstruction via direct Fourier inversion}  \\ 
 \hline
Th 8 Apr 2021 & \tiny{8 AM PST} & sharpen & variational autoencoders  \\ 
 \hline
Th 15 Apr 2021 & \tiny{8 AM PST} & sharpen & cryoDRGN (variational autoencoders) with Ellen Zhong  \\ 
 \hline
Th 22 Apr 2021 & \tiny{8 AM PST} & blur/sharpen & office hours  \\ 
 \hline
Th 29 Apr 2021 & \tiny{8 AM PST} & blur/sharpen & \tiny{Guest Lecture: J. Krieger, normal mode analysis \& prody}  \\ 
 \hline
Th 6 May 2021 & \tiny{8 AM PST} & sharpen & \tiny{Guest Lecture: J. Krieger, normal mode analysis \& prody} \\ 
 \hline
Th 13 May 2021 & \tiny{8 AM PST} & blur & \tiny{Guest Lecture: Yong Zi Tan. Becoming a power user: Tilting}  \\ 
 \hline
Th 20 May 2021 & \tiny{8 AM PST} & blur/sharpen & office hours  \\ 
 \hline
Th 27 May 2021 & \tiny{8 AM PST} & blur & \tiny{Fourier transforms and reciprocal space for the beginner (G. Jensen's course)}  \\ 
 \hline
Th 3 June 2021 & \tiny{8 AM PST} & blur/sharpen & office hours  \\ 
 \hline
Th 10 June 2021 & \tiny{8 AM PST} & blur & \tiny{Fourier transforms and reciprocal space for the beginner (G. Jensen's course)}  \\
 \hline
TBD & \tiny{8 AM PST} & blur/sharpen & Wah Chiu et al, lectures, ...  \\ [1ex] 
 \hline
 ... 2021 ... & ... &  ... & ...  \\ 
 \hline
\end{tabular}
\end{center}

\section{Organizational Team}

I would appreciate help 
\begin{itemize}
	\item {\bf Giving lectures. You can send a proposal to me including topic, format, time, date.}
	\item {\bf Being the leader of a breakout room to answer questions. You could list your areas of expertise, so people would know to come to you for those things. A sort of 'office hours'.}
	\item Developing the syllabus, and suggesting (or making) learning content.
	\item Formulating challenge problems to test comprehension, build intuition, and conceptual understanding.
	\item Zoom co-host and admin help.
\end{itemize}

\section{Slack}
We will use the Slack channel 'cryoem\_study\_group' for asynchronous chat. Please join the Slack group and ask questions there, rather than emailing me, as I may not respond! You can request a link to join by emailing me.


\section{Syllabus}
We will start off drawing heavily from the content developed by Dr Frederick Sigworth, \url{https://cryoemprinciples.yale.edu/video-lectures}. If you are having problems with links, then try viewing his content on YouTube.

Thanks to the interactive learning material developed by \href{http://cryoem.tudelft.nl/group/arjen-jakobi/}{Arjen Jakobi}, for a course on \href{https://gitlab.tudelft.nl/aj-lab/teaching/-/wikis/NB4020}{High-Resolution Imaging at TUDelft}: "The practicals are computational assignments in the form of interactive Jupyter notebooks hosted in a virtual learning environment. These notebooks contain code that can be executed to perform certain tasks or visualise results; you do not need any active knowledge of coding to work through the notebook." For the curious, the code that generates the visualizations is available on the repository.

If you haven't already gone through Grant Jensen's \href{https://www.caltech.edu/about/news/grant-jensen-cryo-em}{popular} online course \href{https://jensenlab.caltech.edu/courses/}{'Getting Started in Cryo-EM' }, now would be a good time to do so. I think enough people have gone through this on their own that we will mainly draw from other material. 

\pagebreak
\section{Upcoming Meetings}

\pagebreak
\subsection{1 Apr 2021 - Sharpen - 3D Reconstruction via Direct Fourier Inversion.}

\textendash{Learning objectives}
\begin{enumerate}
  \item understand implementation details of 2D $\rightarrow$ 3D Fourier inversion
  \item understand what kinds of map artifacts can arise during Fourier inversion
  \item play with Fourier inversion of simple shapes, to build intuition
\end{enumerate}
\textendash{Pre-reading}
\begin{enumerate}
	\item \href{https://www.projectrhea.org/rhea/index.php/ECE637_tomographic_reconstruction_fourier_slice_theorem_S13_mhossain}{The Bouman Lectures on Image Processing. A Slecture by Maliha Hossain. Subtopic 6: Fourier Slice Theorem. 2013} (notes and 25 min video)
 	\item \href{https://youtu.be/YIvTpW3IevI}{ASTRA Toolbox: Fourier Slice Theorem} (3 min)
	\item \href{https://youtu.be/DcmL1JGoiPs}{ASTRA Toolbox: Proof of Fourier Slice Theorem} (2 min)
	\item \href{https://youtu.be/pZ7JlXagT0w}{ASTRA Toolbox: Filtered Backprojection (FBP)} (4 min)
\end{enumerate}
\textendash {Questions}
\begin{enumerate}
	\item Go to \href{https://github.com/geoffwoollard/learn_cryoem_math/blob/master/nb/fourier_slice_2D_3D_with_trilinear.ipynb}{this coding notebook} on Fourier inversion. Play around with things to build your intuition. You can look into the code that is doing the Fourier transforms or interpolation to see what is "inside the black box". Are there any artefacts in the reconstruction? What happens where there are less particles, errors in the alignments?
	\item Let's say you are trying to do a reconstruction, and you see some artefacts that are difficult to interpret, but that might be caused by angular estimates, preferred orientations, contrast/SNR is not good enough - or a combination of all of those causal factors. How could you play around with a synthetic example to track down what is causing artefacts in your reconstruction?
\end{enumerate}


\pagebreak
\subsection{8 Apr 2021 - Sharpen - Variational Autoencoders }
\textendash{Pre-reading}
\begin{enumerate}
	\item \href{https://www.siarez.com/projects/variational-autoencoder}{Variational autoencoder interactive demos with deeplearn.js}
	\begin{enumerate}
		\item Doersch, C. (2016). Tutorial on Variational Autoencoders, 1-23. \url{https://arxiv.org/pdf/1606.05908.pdf} (23 pages)
	\end{enumerate}
	\item \href{https://youtu.be/_2PZxw4FzDU}{015 Jensen's inequality \& Kullback Leibler divergence} (10 min)
	\item \href{https://www.youtube.com/watch?v=uaaqyVS9-rM&feature=youtu.be}{Ali Ghodsi, Lec : Deep Learning, Variational Autoencoder, Oct 12 2017 [Lect 6.2]} (1 hr)
	\item \href{https://youtu.be/P78QYjWh5sM}{Deep Learning Lecture 14: Karol Gregor on Variational Autoencoders and Image Generation} (43 min)
	\item \href{http://videolectures.net/deeplearning2015_courville_autoencoder_extension/}{Aaron Courville. 2015. Variational Autoencoder and Extensions. Deep Learning Summer School, Montreal.} (1.5 hrs)
\end{enumerate}
\textendash {Questions}
\begin{enumerate}
	\item Code up a variational autoencoder on some toy data. For example in \href{https://tiao.io/post/tutorial-on-variational-autoencoders-with-a-concise-keras-implementation/}{Keras} or \href{https://towardsdatascience.com/variational-autoencoder-demystified-with-pytorch-implementation-3a06bee395ed}{PyTorch}
\end{enumerate}

\subsection{15 Apr 2021 - Sharpen - Guest Lecture with Ellen Zhong (MIT), cryoDRGN \& Variational Autoencoders}
\textendash{Pre-reading}
\begin{enumerate}
	\item \href{https://youtu.be/yft_qhErStg}{Ellen Zhong. 2020. CryoDRGN: Deep generative models for reconstructing heterogeneous protein structures from cryo-EM. SBGrid Consortium (40 min).}
	\item Bepler, T., Zhong, E. D., Kelley, K., Brignole, E., \& Berger, B. (2019). Explicitly disentangling image content from translation and rotation with spatial-VAE, (NeurIPS 2019).
	\item Zhong, E. D., Bepler, T., Davis, J. H., \& Berger, B. (2019). Reconstructing continuous distributions of 3D protein structure from cryo-EM images. ICLR 2020, 1-20. \url{https://arxiv.org/pdf/1909.05215.pdf}
	\item Nature Methods paper on cryoDRGN (to appear $\sim$ Feb 2021)
\end{enumerate}
\textendash {Questions}
\begin{enumerate}
	\item Install \href{https://github.com/zhonge/cryodrgn}{cryoDRGN} and run it on your own data.
\end{enumerate}

\subsection{22 Apr 2021 - Blur/Sharpen - Office Hours }
\textendash{Pre-reading}
\begin{enumerate}
	\item \href{https://youtu.be/eRPue0-Pkw4}{S2C2 CryoEM Image Processing Workshop: Day 1} (5 hrs)
	\end{enumerate}
\textendash {Questions}
\begin{enumerate}
	\item Some data processing algorithms have many parameters, and it can be difficult to understand what eactly they are all doing, which ones go together, and when you would use them, how they would change things, and when you'd know that things are working. Find some parameters in a data processing algorithm that you don't understand, and bring it to the office hours to discuss. If you have time, run some jobs by changing a few parameters.
	\item Some people would like to know more about how an cryoEM algorithm works, but can't follow the original paper describing. Bring some results you've generated from some cryoEM data processing algorithm to discuss.
	\item Some data processing algorithms generate intermediate plots. If you know how to interpret these plots, they can help diagnose if the algorithm it working how you think it should be. Bring some plots that you have difficulty understanding to the office hours to discuss.  
	\item Some cryoEM discussion forums have "power users" that really understand things thoroughly. If you can follow how they are thinking, you can learn a lot, trouble shoot your data processing problems, and move your projects along. Find some posts and threads with these power users, and bring them to the office hours to discuss.
\end{enumerate}


\subsection{29 Apr 2021 - Blur - Guest Lecture with Dr. James Krieger (University of Pittsburgh), normal mode analysis \& prody}
\textendash{Pre-reading}
\begin{enumerate}
	\item \href{https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2836427/}{Bahar, I., Lezon, T. R., Bakan, A., \& Shrivastava, I. H. (2010). Normal Mode Analysis of Biomolecular Structures: Functional Mechanisms of Membrane Proteins. Chemical Reviews, 110(3), 1463-1497. http://doi.org/10.1021/cr900095e}
	\item Prody \href{http://prody.csb.pitt.edu/}{website}
\end{enumerate}
\textendash {Questions}
\begin{enumerate}
	\item Have a look at some \href{http://prody.csb.pitt.edu/tutorials/}{prody tutorials}
	\item In reality, each single particle image is a slightly different conformation. Let's assume that individual particles are fluctuations around an average reference state, and that the fluctuations are described well by the 'large breathing motions' described by normal mode approaches. How does this type of heterogeneity affect the final reconstruction? If heterogeneous particles go into one structure, what might happen to the error in their alignment estimation?
	\item How can physics based models, the type prody uses, be incorporated into cryoEM data processing and analysis?
\end{enumerate}

\subsection{6 May 2021 - Sharpen - Guest Lecture with Dr. James Krieger (University of Pittsburgh), normal mode analysis \& prody}
\textendash{Pre-reading}
\begin{enumerate}
	\item "2. Theory" section (pp. 1470-1477) in \href{https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2836427/}{Bahar, I., Lezon, T. R., Bakan, A., \& Shrivastava, I. H. (2010). Normal Mode Analysis of Biomolecular Structures: Functional Mechanisms of Membrane Proteins. Chemical Reviews, 110(3), 1463-1497. http://doi.org/10.1021/cr900095e}
	\item Prody \href{https://github.com/prody/ProDy}{source}, especially \href{https://github.com/prody/ProDy/tree/master/prody/dynamics}{dynamics}
\end{enumerate}
\textendash {Questions}
\begin{enumerate}
	\item How can physics based models, the type prody uses, be incorporated into cryoEM data processing and analysis?
	\item What are the computational bottlenecks (runtime, memory) in the types of approaches in \href{https://github.com/prody/ProDy/tree/master/prody/dynamics}{prody.dynamics}?
\end{enumerate}

\subsection{13 May 2021 - Blur/Sharpen - Guest Lecture: Yong Zi Tan (The Hospital for Sick Children, Toronto, Canada). Becoming a power user: Tilting}
%\textendash{Pre-reading}
%\begin{enumerate}
%	\item 
%	\end{enumerate}
%\textendash {Questions}
%\begin{enumerate}
%	\item Install 
%\end{enumerate}

\subsection{20 May 2021 - Blur/Sharpen - Office Hours}
\textendash{Pre-reading}
\begin{enumerate}
	\item \href{https://youtu.be/ehXqLnV_Jr4}{S2C2 CryoEM Image Processing Workshop: Day 2 Part 1} (3h:20m)
	\end{enumerate}
\textendash {Questions}
\begin{enumerate}
	\item Some data processing algorithms have many parameters, and it can be difficult to understand what eactly they are all doing, which ones go together, and when you would use them, how they would change things, and when you'd know that things are working. Find some parameters in a data processing algorithm that you don't understand, and bring it to the office hours to discuss. If you have time, run some jobs by changing a few parameters.
	\item Some people would like to know more about how an cryoEM algorithm works, but can't follow the original paper describing. Bring some results you've generated from some cryoEM data processing algorithm to discuss.
	\item Some data processing algorithms generate intermediate plots. If you know how to interpret these plots, they can help diagnose if the algorithm it working how you think it should be. Bring some plots that you have difficulty understanding to the office hours to discuss.  
	\item Some cryoEM discussion forums have "power users" that really understand things thouroughlly. If you can follow how they are thinking, you can learn a lot, trouble shoot your data processing problems, and move your projects along. Find some posts and threads with these power users, and bring them to the office hours to discuss.
\end{enumerate}

\subsection{27 May 2021 - Blur - Fourier transforms and reciprocal space for the beginner (Grant Jensen's course)}
\textendash{Pre-reading}
\begin{enumerate}
%	\item \href{https://youtu.be/-EAQm8wgLbc}{Part 2: Fourier Transforms for Beginners - G. Jensen} (1 min)
%	\item \href{https://youtu.be/OESy_ltOCvI}{Part 2: 1-D Sine Waves and Their Sums - G. Jensen} (33 min)
%	\item \href{https://youtu.be/IUaqeoMK5y4}{Part 2: 1-D Reciprocal Space - G. Jensen} (20 min)
	\item \href{https://youtu.be/nyk75ufbP74}{Part 2: 2-D Waves and Images - G. Jensen} (19 min)
	\item \href{https://youtu.be/fEyLh9HqsWU}{Part 2: 2-D Transforms and Filters - G. Jensen} (33 min)
%	\item \href{https://youtu.be/INtehLmqfmA}{Part 2: 3-D Waves and Transforms - G. Jensen} (13 min)
%	\item \href{https://youtu.be/MQm6ZP1F6ms}{Part 2: Convolution and Cross-Correlation - G. Jensen} (15 min)
	\end{enumerate}
%\textendash {Questions}
%\begin{enumerate}
%	\item Install 
%\end{enumerate}

\subsection{3 June May 2021 - Blur/Sharpen - Office Hours}
\textendash{Pre-reading}
\begin{enumerate}
	\item \href{https://youtu.be/HXIipHORI2Y}{S2C2 CryoEM Image Processing Workshop: Day 2 Part 2} (3h:40m)
	\end{enumerate}
\textendash {Questions}
\begin{enumerate}
	\item Some data processing algorithms have many parameters, and it can be difficult to understand what eactly they are all doing, which ones go together, and when you would use them, how they would change things, and when you'd know that things are working. Find some parameters in a data processing algorithm that you don't understand, and bring it to the office hours to discuss. If you have time, run some jobs by changing a few parameters.
	\item Some people would like to know more about how an cryoEM algorithm works, but can't follow the original paper describing. Bring some results you've generated from some cryoEM data processing algorithm to discuss.
	\item Some data processing algorithms generate intermediate plots. If you know how to interpret these plots, they can help diagnose if the algorithm it working how you think it should be. Bring some plots that you have difficulty understanding to the office hours to discuss.  
	\item Some cryoEM discussion forums have "power users" that really understand things thouroughlly. If you can follow how they are thinking, you can learn a lot, trouble shoot your data processing problems, and move your projects along. Find some posts and threads with these power users, and bring them to the office hours to discuss.
\end{enumerate}

\subsection{10 June 2021 - Blur - Fourier transforms and reciprocal space for the beginner (Grant Jensen's course)}
\textendash{Pre-reading}
\begin{enumerate}
%	\item \href{https://youtu.be/-EAQm8wgLbc}{Part 2: Fourier Transforms for Beginners - G. Jensen} (1 min)
%	\item \href{https://youtu.be/OESy_ltOCvI}{Part 2: 1-D Sine Waves and Their Sums - G. Jensen} (33 min)
%	\item \href{https://youtu.be/IUaqeoMK5y4}{Part 2: 1-D Reciprocal Space - G. Jensen} (20 min)
%	\item \href{https://youtu.be/nyk75ufbP74}{Part 2: 2-D Waves and Images - G. Jensen} (19 min)
%	\item \href{https://youtu.be/fEyLh9HqsWU}{Part 2: 2-D Transforms and Filters - G. Jensen} (33 min)
	\item \href{https://youtu.be/INtehLmqfmA}{Part 2: 3-D Waves and Transforms - G. Jensen} (13 min)
	\item \href{https://youtu.be/MQm6ZP1F6ms}{Part 2: Convolution and Cross-Correlation - G. Jensen} (15 min)
	\end{enumerate}
%\textendash {Questions}
%\begin{enumerate}
%	\item Install 
%\end{enumerate}


\pagebreak
\subsection{Spring/Summer 2021}
By this time the anticipated textbook by Wah Chiu, Robert Glaeser, and Eva Nogales will hopefully be out, and we can see how it looks. We could also plan some lectures.

%\subsection{20 May 2021 - Sharpen - Electron Optics: Lens Aberations }
%\textendash{Pre-reading}
%\begin{enumerate}
%	\item "2.3 Lens Abberations" (pp. 31-40) in Reimer, L., \& Kohl, H. (2008). Transmission Electron Microscopy Physics of Image Formation. Springer series in optical sciences (Vol. 51). http://doi.org/10.1007/978-0-387-34758-5
%	\end{enumerate}
%%\textendash {Questions}
%%\begin{enumerate}
%%	\item Install 
%%\end{enumerate}

%\subsection{3 June May 2021 - Sharpen - Electron Optics: Electron Waves and Phase Shifts }
%\textendash{Pre-reading}
%\begin{enumerate}
%	\item "3.1 Electron Waves and Phase Shifts" (pp. 45-55) in Reimer, L., \& Kohl, H. (2008). Transmission Electron Microscopy Physics of Image Formation. Springer series in optical sciences (Vol. 51). http://doi.org/10.1007/978-0-387-34758-5
%	\end{enumerate}
%%\textendash {Questions}
%%\begin{enumerate}
%%	\item Install 
%%\end{enumerate}


\pagebreak
\section{Past Meetings}


\subsection{19 Nov 2020 - Background Math \& Defocus Phase Contrast}
\subsubsection{Blur}
\textendash {Pre-reading}
\begin{itemize}
\item \href{https://youtu.be/CZkPG95eoS0}{Complex numbers and the complex exponential} (10 min)
\item \href{https://cryoemprinciples.yale.edu/sites/default/files/files/1%20Review%20of%20Complex%20Numbers.pdf}{Review	of complex	numbers} (3 pages)
\item \href{https://youtu.be/m2Hm1ziZFZg}{Defocus phase contrast} (35 min)

\end{itemize}
\textendash {Questions}
\begin{itemize}
\item What is physically happening to the sample when the electron is detected at small diffraction angles vs large diffraction angles? What else can happen to the electron?
%Watch video 2.1 (10 min). Towards the end (7:40 mark) Dr. Sigworth makes some interesting 2D/3D plots showing the real and imaginary part of exp(i theta). Code up a way to plot this and share it with everyone. For example, you could publish a coding notebook on something like GitHub.
\end{itemize}

\subsubsection{Sharpen}
\textendash{Pre-reading}
\begin{itemize}
	\item \href{https://youtu.be/m2Hm1ziZFZg}{Defocus phase contrast} (35 min)
	\item 6.2 The Wave Equation for Fast Electrons in 'Advanced Computing in Electron Microscopy', Kirkland (2020), pp. 156-159.
\end{itemize}
\textendash {Questions}
\begin{itemize}
\item In Sigworth's derivation of $|\Psi|^2$ in the 'Defocus phase contrast' video, he made various assumptions such as small theta, small epsilon. Under what extreme conditions would they break down. Do these occur in cryoEM? In other experimental regimes besides what is typical in cryoEM?
\item Around the 23-25 min mark of the 'Defocus phase contrast' video the CTF seems to oscillate to zeros. Is this observed in practice? Why or why not?
\item Work through the derivation with pencil and eraser, justifying each step as best you can. come with your questions to the group study.
\item Biological samples are made of atoms that give faint contrast, when compared to samples with higher atomic numbers. Where does the atomic number of the sample come into the equations presented here? 
\end{itemize}

\subsection{3 Dec 2020 - Blur - Fourier Transform}
\textendash {Pre-reading}
\begin{itemize}
	\item \href{https://youtu.be/27bNryOu84g}{The Fourier transform in one dimension} (35 min)
	\item \href{https://cryoemprinciples.yale.edu/sites/default/files/files/3%20Fourier1D.pdf}{The 1D Fourier Transform} (7 pages)
	\item Interactive coding notebook \href{https://gitlab.tudelft.nl/aj-lab/teaching/-/wikis/NB4020}{'Practical 1 - Fundamentals of Image Processing'} in the High-resolution imaging course at TUDelft. Note there are multiple notebooks: Introduction, Fourier Series, Frequency Spectrum, 2-D Fourier Analysis. See the links at the bottom. For this week, work through notebooks "ip\_basics\_part1", "ip\_basics\_part2", "ip\_basics\_part3".
\end{itemize}
\textendash {Questions}
\begin{itemize}
	\item Prove the linearity, scale, shift, convolution properties of the FT in 1D.
	\item Equation 4 in \href{https://cryoemprinciples.yale.edu/sites/default/files/files/3%20Fourier1D.pdf}{The 1D Fourier Transform} expresses how "a narrower function of x transforms into a broader function of u". Can you think of some examples of this in practice? Hint: what happens when you change magnification? 
	\item Assume you have a 128 \AA box size, with pixel size of 1 \AA. What is the spacing spacing between bins in Fourier space, if there are 64 bins in the negative direction and 64 bins in the positive direction? What length ranges (in units of \AA) do the first few and last few frequency bins correspond to?  How many frequency bins are between 10 and 5 \AA, versus 5 and 2.5 \AA? \\ Hint: $\langle..., [0,1/128), [1/128,2/128), ... , [\frac{128/2-2}{128}, \frac{128/2-1}{128}),  [\frac{128/2-1}{128}, \frac{128/2}{128})\rangle$.
\end{itemize}

\subsection{10 Dec 2020 - Sharpen - Fourier Transform}
\textendash {Pre-reading}
\begin{itemize}
\item \href{https://youtu.be/J1ViNmmQnd0}{The Fourier transform in two and three dimensions} (43 min)
	\item \href{https://cryoemprinciples.yale.edu/sites/default/files/files/4%20Fourier2D-3D.pdf}{2D and 3D Fourier transforms} (9 pages)
	\item Interactive coding notebook \href{https://gitlab.tudelft.nl/aj-lab/teaching/-/wikis/NB4020}{'Practical 1 - Fundamentals of Image Processing'} in the High-resolution imaging course at TUDelft. Note there are multiple notebooks: Frequency Spectrum, 2-D Fourier Analysis. See the links at the bottom. For this week, play with notebooks "ip\_basics\_part4", "ip\_basics\_part5".
	\item Optional
	\begin{itemize}
		\item \href{http://www.fftw.org/links.html}{Explanatory Material:} "Tutorials and introductions to Fourier transforms and FFTs, in no particular order." \url{fftw.org}
		\item \href{http://homepages.inf.ed.ac.uk/rbf/CVonline/LOCAL_COPIES/PIRODDI1/NUFT/NUFT.html}{Roberta Piroddi and Maria Petrou. Non-Uniform Fourier Transform: A Tutorial}
		\item \url{https://en.wikipedia.org/wiki/Non-uniform_discrete_Fourier_transform}
	\end{itemize}
\end{itemize}

\textendash{Questions}
\begin{itemize}
	\item Sample a simple function (e.g. $\exp$, $\sin$, gaussian) in 1D or 2D. Then use some library to compute the FFT. Then compute the DFT in your own implementation. How close is the error? Work our the solution analytically for the continuous case. What should the answer be at some discrete points according to the continuous case, and how is it different from what the FFT gave? What is the typical floating point error? What was the speedup of the FFT, and how does this compare to the theoretical limit?
	\item In practice, how long are FFTs taking (2D and 3D)? How does this compare with other computational bottlenecks like disk I/O and interpolation?
	\item What are some numerical issues or bottlenecks that can arise when using an implementation of the FFT in practice? What are some ways to overcome them?
\end{itemize}

\subsection{17 Dec 2020 - Blur - Convolution, Sampling, Nyquist}
\textendash {Pre-reading}
\begin{itemize}
	\item \href{https://youtu.be/_F-YDwY9X30}{Fourier transform: convolution, sampling and Nyquist} (37 min)
	\item Interactive coding notebook \href{https://gitlab.tudelft.nl/aj-lab/teaching/-/wikis/NB4020}{'Practical 1 - Fundamentals of Image Processing'} in the High-resolution imaging course at TUDelft. Note there are multiple notebooks: 2-D Fourier Analysis, Convolutions. See the links at the bottom. For this week, work through notebook "ip\_basics\_part6".
\end{itemize}
\textendash {Questions}
\begin{itemize}
	\item Solve the "homework problem" (without peeking at the answer!) in the first part of \href{https://youtu.be/_F-YDwY9X30}{Fourier transform: convolution, sampling and Nyquist}. If $g(x) = e^{-\pi(x-2)^2} - e^{-\pi(x+2)^2}$, what is $G(u)$?
	\item By the Convolution theorem $f(x)=g(x)*h(x) \Rightarrow F(u)=G(u)H(u)$. Since $F(u)=G(u)H(u)=H(u)G(u)$ we should have $f(x)=g(x)*h(x)=h(x)*g(x)$. Show explicitly the commutativity of the convolution operator: i.e., $g(x)*h(x)=\int dt \ g(t)h(x-t)=\int dt \ h(t)g(x-t)=h(x)*g(x)$
	\item Look at the animation in the notebook "ip\_basics\_part6". Write down the mathematical object that is being visualized, including integration bounds. What does one snapshot of the animation represent?
	\item When does convolution (physically or computationally) happen in cryoEM happen? Be specific when connecting things back to the math, e.g. what is being convolved, what is it's functional form, and how many dimensions are involved?
	\item When we convolve with a {\it broad/wide} gaussian function, what is happening in Fourier space? How does this relate to Fourier filtering? Hint, use the convolution theorem.
\end{itemize}

\subsection{7 Jan 2021 - Sharpen - Convolution, Sampling, Nyquist}
\textendash{Pre-reading}
\begin{itemize}
	\item \href{https://youtu.be/_F-YDwY9X30}{Fourier transform: convolution, sampling and Nyquist} (37 min)
	\item Interactive coding notebook \href{https://gitlab.tudelft.nl/aj-lab/teaching/-/wikis/NB4020}{'Practical 1 - Fundamentals of Image Processing'} in the High-resolution imaging course at TUDelft. Note there are multiple notebooks. For this week, work through notebook "ip\_basics\_part6".
\end{itemize}
\textendash {Questions}
\begin{itemize}
	\item Around the 16 min mark in \href{https://youtu.be/_F-YDwY9X30}{Fourier transform: convolution, sampling and Nyquist}, we see that the de-convoluted (recovered) signal blows up around the origin, where there is a delta function. From the math, why exactly did this happen? Is there a way to over come this blowing up effect?
	\item Let $f_a=e^{-ax^2} \ ; \ a>0$. Show that $f_1*(f_2*f_3) = (f_1*f_2)*f_3$. Note that $\int_{-\infty}^{+\infty} dx \ e^{-ax^2} = \sqrt{\pi/a}$
	\item The notebook "ip\_basics\_part6" has an interactive where the size of the kernel (Sobel, Gaussian, etc) can be changed. Convoluting with larger kernels could be a more expensive computation, but we could speed it up by doing this in Fourier space by the convolution theorem. If we take the FT of the image and kernel, there sizes to not match, so how can we multiply them element wise? How would you match the pixel sizes and do things in Fourier space to achieve the same result as the real space convolution?
	\item In the last part of "ip\_basics\_part6", the Fourier filtering versus the convolution filtering appear the same for Guassian blur, but different for box blur, and very different for sharpen. What might be causing this? Vary the kernel size and notice the different run times. Is doing things in Fourier space always quicker? 
	\item How can we increase the Nyquist frequency during data collection to get higher resolution information? What is the trade off? What should guide our choice of an optimal Nyquist, given our particular microscope and specimen?
	\item Code up a simple example illustrating the convolution theorem, where you also actually do the convolution in real space. How close is it to the answer where you did the multiplication in Fourier space? What was the speedup? Now try speeding up the calculation by of the convolution in real space by making the convolution kernel smaller. How good of an approximation is this? Use a 2D projection of a 3D density map and a meaningful kernel (e.g. low pass filter) to build your intuition in a useful way.
\end{itemize}

\subsection{14 Jan 2020 - Blur - Phase-contrast in the EM}
\textendash{Pre-reading}
\begin{itemize}
	\item \href{https://cryoemprinciples.yale.edu/sites/default/files/files/2%20Phase%20contrast.pdf}{Phase-contrast imaging in the EM'} (10 pages)
	\item Interactive coding notebook \href{https://gitlab.tudelft.nl/aj-lab/teaching/-/wikis/NB4020}{'Practical 1 - Fundamentals of Image Processing'} in the High-resolution imaging course at TUDelft. Note there are multiple notebooks. Go to the one on the CTF ('ip\_basics\_part7').
\end{itemize}
\textendash {Questions}
\begin{enumerate}
	\item See panel (b) in the \href{https://static5.olympus-lifescience.com/data/olympusmicro/primer/images/mtf/modulationfigure6.jpg?rev=480E}{'signal star'} image. What would this image look like if the CTF was applied (i.e. through convolution)?
	\item As defined in equation 11 of \href{https://cryoemprinciples.yale.edu/sites/default/files/files/2%20Phase%20contrast.pdf}{'Phase-contrast imaging in the EM'}, what happens when the B factor is negative versus positive?
	\item In practice, on the scope, the CTF is easier to see in an FFT if you are at high mag. Why? Can you relate this back to the math? How is magnification playing into the equation?
	\item Can you tell the difference between underfocus and overfocus by eye? Try putting what you see into words? Why do they look different?
	\item As defined in equation 11 in \href{https://cryoemprinciples.yale.edu/sites/default/files/files/2%20Phase%20contrast.pdf}{'Phase-contrast imaging in the EM'}, what physical behaviour is involved in this B factor? What other factors of B are there in cryoEM and what physical behaviour is involved in those B factors? Why are they all called B-factors?
	\item With reference to equation 11 in \href{https://cryoemprinciples.yale.edu/sites/default/files/files/2%20Phase%20contrast.pdf}{'Phase-contrast imaging in the EM'}: "B has units of nm$^2$ or $ \AA^2$ and is called the 'B-factor' or 'envelope factor'. Good cryo-EM images have B values of $50-100 \AA^2$, but even these values are not so ideal. At $B = 100  \AA^ 2$ spatial frequencies of $5 \AA^2$ are attenuated to 1/e of their original amplitude, and higher spatial frequencies are attenuated even more". Go to 'ip\_basics\_part7' and play with B. Is there agreement between the B factor explanation and the interactive notebook? Take a closer look at how the interactive notebook \href{https://gitlab.tudelft.nl/aj-lab/teaching/-/blob/master/binder/hri_practical01/shared/misc.py#L757}{codes up the B factor} and what pixel size is used/assumed.
	\item Play with the amplitude contrast. Do you 'want' more or less amplitude contrast? If the amplitude contrast is off, how will this effect CTF fitting? Can you think of a good reason why many CTF estimators do not fit amplitude contrast? If you are unsure as to the amplitude contrast, what should you do?
	\item Play around with 'plot\_ctf\_img\_interactive' in Question 4 of 'ip\_basics\_part7'. Turn on 'ctf\_multiply'. Can you see how the information is delocalized more when the defocus increases? How defocused can the image get? Where does the information delocalize to? When collecting data on a real micrograph (versus computationally applying the CTF to a synthetic image the size of a particle), what issues would you have?
\end{enumerate}

\subsection{21 Jan 2021 - Sharpen - Phase-contrast in the EM}
\textendash{Pre-reading}
\begin{itemize}
	\item  Philippsen et al. 2007. "The contrast-imaging function for tilted specimens" \url{https://www.sciencedirect.com/science/article/pii/S0304399106001525}
	\item Voortman et al. 2011. "A fast algorithm for computing and correcting the CTF for tilted, thick specimens in TEM" \url{https://www.sciencedirect.com/science/article/pii/S0304399111000878}
	\item Voortman et al. 2012. "Fast, spatially varying CTF correction in TEM" \url{https://pubmed.ncbi.nlm.nih.gov/22728402/}	
\end{itemize}
%\textendash {Questions}
%\begin{itemize}
%	\item 
%\end{itemize}

\subsection{28 Jan 2021 - Blur - Image Formation (Forward Model)}
\textendash{Pre-reading}
\begin{itemize}
	\item \href{https://youtu.be/tzv5c5K7MEk?t=4690}{NCCAT SPA short course 2020, Lecture 4: Algorithms and foundational math Part I \& 2, Fred Sigworth} (1:18:10 - 1:28:46, ~10 min)
	\end{itemize}
\textendash {Questions}
\begin{enumerate}
	\item How is real noise different from Gaussian additive noise? What makes it different? 
	\item  If particles come from different types of grids (thin continuous carbon, single layer graphene) can they be combined into one large dataset to solve a structure?
	\item Why don't researchers pool different datasets of the same particle (e.g. from different EMPIAR entries) to solve a high resolution structure with tens of millions of particles?
\end{enumerate}

\subsection{11 Feb 2021 - Sharpen - Image Formation (Forward Model), Multislice}
\textendash{Pre-reading}
\begin{enumerate}
	\item 'Theory' section in Koeck, P. J. B., \& Karshikoff, A. (2015). Limitations of the linear and the projection approximations in three-dimensional transmission electron microscopy of fully hydrated proteins. Journal of Microscopy, 259(3), 197-209. \url{http://doi.org/10.1111/jmi.12253}
	\item Section '2. Theory' in Vulovi\'{c}, M., Ravelli, R. B. G., van Vliet, L. J., Koster, A. J., Lazi\'{c}, I., L\"ocken, U., Rieger, B. (2013). Image formation modeling in cryo-electron microscopy. Journal of Structural Biology, 183(1), 19?32. \url{http://doi.org/10.1016/j.jsb.2013.05.008}
	\begin{itemize}
		\item Supplementary material associated with the article (18 pages)
	\end{itemize}
	\item 6.2 The Wave Equation for Fast Electrons in 'Advanced Computing in Electron Microscopy', Kirkland (2020), pp. 156-159.
	\item 6.4 The Multislice Solution in 'Advanced Computing in Electron Microscopy', Kirkland (2020), pp. 162-165.
\end{enumerate}

\textendash {Questions}
\begin{enumerate}
	\item Equation 7 in Vulovi\'{c} et al. shows the DQE/NTF being applied. In practice, the DQE/MTF/NTF is often plotted in 1D in papers. What would be the difference between doing the convolution of the DQE/NTF in 2D versus 1D?
	\item Equation 5 in Vulovi\'{c} et al. shows the 'complex CTF'. What is the difference between this and the $\sin$ CTF that is often used? When is it appropriate to use one versus the other treatment?
	\item Simpler models assume additive gaussian noise and pixel independence, for instance see \href{https://youtu.be/tzv5c5K7MEk?t=4690}{NCCAT SPA short course 2020, Lecture 4: Algorithms and foundational math Part I \& 2, Fred Sigworth} (1:18:10 - 1:28:46, ~10 min). Is this the case in Vulovi\'{c} et al.? If so, what sorts of models would break the pixel independence?
	\item For the sake of argument, let's say that our goal is to use more accurate forward models (multislice based, higher order series expansions phase and amplitude object), instead of projection. In practice, how would one go about doing 3D reconstruction with these more accurate forward models? What would be the computational bottlenecks in doing so?
	\item What is the difference between the 'weak approximation' and the 'projection assumption'? See the discussion in Koeck \& Karshikoff (2015), 'Multisclie and single projection simulations of image formation with amplitude and phase contrast', p 204. Go through the derivation in Koeck \& Karshikoff (2015), and point out where precisely the assumptions are made. 
\end{enumerate}

%\pagebreak
%\subsection{18 Feb 2021 - Blur - 2D Expectation-maximization}
%\textendash{Pre-reading}
%\begin{itemize}
%	\item \href{https://repository.upenn.edu/cgi/viewcontent.cgi?article=1665&context=physics_papers}{Nelson, P. C. (2019). Chapter 12 : Single Particle Reconstruction in Cryo-electron Microscopy. In Physical Models of Living Systems (pp. 305?325).}
%	\item Interactive coding notebook \href{https://gitlab.tudelft.nl/aj-lab/teaching/-/wikis/NB4020}{'Practical 2 - 2D/3D reconstruction'} in High-resolution imaging course at UTDelft.
%\end{itemize}
%\textendash {Questions}
%\begin{itemize}
%	
%\end{itemize}

\subsection{18 Feb 2021 - Sharpen - 2D Expectation-maximization}
\textendash{Pre-reading}
\begin{enumerate}
	\item Eddy, S. R. (2004). What is Bayesian statistics? Nature Biotechnology, 22(9), 1177?1178. \url{http://doi.org/10.1038/nbt0904-1177}
	\item \href{https://repository.upenn.edu/cgi/viewcontent.cgi?article=1665&context=physics_papers}{Nelson, P. C. (2019). Chapter 12 : Single Particle Reconstruction in Cryo-electron Microscopy. In Physical Models of Living Systems (pp. 305?325).}
	\item Interactive coding notebook \href{https://gitlab.tudelft.nl/aj-lab/teaching/-/wikis/NB4020}{'Practical 2 - 2D/3D reconstruction'} in the High-resolution imaging course at TUDelft.
\end{enumerate}
\textendash {Questions}
\begin{enumerate}
	\item The primer on Bayesian statistics by S. Eddy concludes: "Using Bayesian methods, we can instead integrate over varying degrees of uncertainty in different aspects of the analysis." What is uncertain in the different aspects of cryoEM analysis? What would be good priors for each of these aspects? In practice, are people taking into account the uncertainty of these parameters, or using point estimates? Why?
	\item Some popular cryoEM software does 2D classification in Fourier space. Why do these equations work in Fourier space? What would have to be changed?
	\item In Nelson's treatment, there was only one 2D class. To do multiple classes, what would have to be changed? What is happening during a typical 2D classification 'round'? What is constant during a round and what is updated between rounds?
	\item How does a prior affect the Log loss function? What functional forms of the priors are convenient for optimization, and what is their interpretation in terms of probability?
	\item It can be shown that iid Gaussian additive noise in real space is also Gaussian additive noise in Fourier space. See \href{https://dsp.stackexchange.com/questions/24170/what-are-the-statistics-of-the-discrete-fourier-transform-of-white-gaussian-nois}{this dsp.stackexchange.com post} for example. Try to generalize this somehow. What happens for iid Gaussian additive noise that is radially dependent in Fourier space, or pixel dependent in real space?
\end{enumerate}

\subsection{25 Feb 2021 - Blur - Coordinate Systems \& Rotations}
\textendash{Pre-reading}
\begin{enumerate}
	\item \href{https://youtu.be/FDyenWWlPdU}{Omega Open Course. 2017. Spherical Coordinate System (With 3D Animation)}
	\item \href{https://youtu.be/w79nZGzWMyI}{Andrew Dotson. 2018. Deriving Spherical Coordinates (For Physics Majors)}
	\item \href{https://accio.github.io/AMIDD/assets/2020/04/JRQuine-MathBiophysicsBook.pdf}{Quine, JR. 4.1.2 Two dimensions, 4.1.3 Three dimensions, 4.2 Complex form of a rotation in {\it  Mathematical Techniques in Structural Biology},  pp. 26-28}
	\item \url{https://en.wikipedia.org/wiki/Euler_angles#Rotation_matrix}
	\item \href{https://www.mecademic.com/en/how-is-orientation-in-space-represented-with-euler-angles}{How is Orientation in Space Represented with Euler Angles?}
	\item \href{http://www.close-range.com/docs/Computing_Euler_angles_from_a_rotation_matrix.pdf}{Gregory G. Slabaugh. Computing Euler angles from a rotation matrix}
	%\item (for reference, don't have to read): \href{https://www.geometrictools.com/Documentation/EulerAngles.pdf}{Euler Angle Formulas}
\end{enumerate}

\textendash {Questions}
\begin{enumerate}
	\item Problems 4, 6, 7, from \href{https://accio.github.io/AMIDD/assets/2020/04/JRQuine-MathBiophysicsBook.pdf}{Quine, JR. 4.5 Problems  in {\it  Mathematical Techniques in Structural Biology},  pp. 30-31}
	\item Implement the pseudo-code in Figure 1 of \href{http://www.close-range.com/docs/Computing_Euler_angles_from_a_rotation_matrix.pdf}{Gregory G. Slabaugh. Computing Euler angles from a rotation matrix}, and use it to compute the Euler angles from a rotation matrix.
\end{enumerate}

\subsection{4 March 2021 - Sharpen - Coordinate Systems \& Rotations}
\textendash{Pre-reading}
\begin{enumerate}
	\item \href{https://www.coursera.org/lecture/robotics-flight/axis-angle-representations-for-rotations-4hTtQ}{Axis/Angle Representations for Rotations}
	\item \href{https://accio.github.io/AMIDD/assets/2020/04/JRQuine-MathBiophysicsBook.pdf}{Quine, JR. 4. Orthogonal Transformations and Rotations in Mathematical Techniques in Structural Biology, pp. 25-31}
    	\item \href{https://youtu.be/d4EgbgTm0Bg}{Visualizing quaternions (4d numbers) with stereographic projection}
	\item \href{https://youtu.be/zjMuIxRvygQ}{Quaternions and 3d rotation, explained interactively}
	\item \href{https://eater.net/quaternions/}{Visualizing quaternions An explorable video series}
	\item \href{https://en.wikipedia.org/wiki/Quaternions_and_spatial_rotation}{Wiki: Quaternions and spatial rotation}
\end{enumerate}
\textendash {Questions}
\begin{enumerate}
	\item all problems from \href{https://accio.github.io/AMIDD/assets/2020/04/JRQuine-MathBiophysicsBook.pdf}{Quine, JR. 4.5 Problems in {\it Mathematical Techniques in Structural Biology},  pp. 30-31}
	\item Go to the \href{https://eater.net/quaternions/video/doublecover}{doublecover} interactive, and select the 4D tab on the bottom. Find the quaternion that corresponds to a rotation of 90 deg in the cw direction about the z axis.
	\item Quaterions can be used to describe the rotation of the point $ r= \langle r_x,r_y,r_x \rangle \in \mathbb{R}^3$ about angle $\theta$ in the direction of vector $\langle q_x,q_y,q_z \rangle$ as follows. $p_{rotated} = q*p*q^{-1}$, where $q = \langle \cos(\theta/2),q_x\sin(\theta/2),q_y\sin(\theta/2),q_j\sin(\theta/2)\rangle$ and \\ $q^{-1}=\langle \cos(-\theta/2),q_x\sin(-\theta/2),q_y\sin(-\theta/2),q_z\sin(-\theta/2) \rangle$ encode the rotation; $\vec r$ is represented as the quaternion $p=(0,r_x,r_y,r_z)$. Question: using pencil and paper, compute the rotation of the point $ r=\langle1,0,0\rangle$ about the z-axis by $\theta=180^{\circ}$ (ccw or cw, it's the same for this angle). Do you get $r=\langle-1,0,0\rangle$? You will have to use the quaternion multiplication table ($ij=k$, etc.), and know how to interconvert quaternions to cartesian 3D vectors.
	\item Study the sections \href{https://en.wikipedia.org/wiki/Quaternions_and_spatial_rotation#Conversion to and from the matrix representation}{Conversion to and from the matrix representation} and \href{https://en.wikipedia.org/wiki/Quaternions_and_spatial_rotation#Performance_comparisons}{Performance comparisons} on the wiki page for \href{https://en.wikipedia.org/wiki/Quaternions_and_spatial_rotation}{Quaternions and spatial rotation}. If we want to rotate many xyz points in space with a 3D rotation, what is the efficient way to do this? Taking into account interconversions between different rotation conventions (Euler angles, rotation matrices, axis-angle, and quaternions) how should we efficiently store rotations versus do rotations?
	\item Besides storing and doing rotations, we have to search over rotations. Wikipedia has a section on \href{https://en.wikipedia.org/wiki/Quaternions_and_spatial_rotation#Differentiation_with_respect_to_the_rotation_quaternion}{Differentiation with respect to the rotation quaternion}. Unpack the equation for $\frac{\partial {\bf p'}}{\partial {\bf q}}$. Would this equation ever be useful in cryoEM? When would we want to estimate the rotation by optimization, and how would we do so with this equation?
%	In some scenarios, it may be useful to compute the gradient of a rotation, wrt
%	
%	If one uses Euler angles to parametrize rotations in cryoEM reconstruction, one can find the alignment of a particle by minimizing (by following the gradient), for instance, the L2 loss of the raw particle and the predicted projection, wrt each Euler angle. If  
\end{enumerate}

\subsection{11 March 2021 - Blur - Interpolation}
\textendash{Pre-reading}
\begin{enumerate}
	\item \href{https://youtu.be/AqscP7rc8_M}{2016. Resizing Images - Computerphile} (bilinear and nearest-neighbour interpolation)
	\item \href{https://youtu.be/poY_nGzEEWM}{2016. Bicubic Interpolation - Computerphile}
	\item \url https://en.wikipedia.org/wiki/Interpolation
\end{enumerate}

\textendash {Questions}
\begin{enumerate}
	\item Go to the Wiki page for \href{https://en.wikipedia.org/wiki/Interpolation}{interpolation} and look at the pictures illustrating different interpolation schemes: nearest-neighbour, linear, polynomial, spline; and 1D vs 2D. How would these schemes differ in terms of "accuracy, cost, number of data points needed, and smoothness of the resulting interpolant function"?
	\item Take a look at \href{https://docs.scipy.org/doc/scipy/reference/generated/scipy.interpolate.griddata.html}{scipy.interpolate.griddata}. When we are interpolating in Fourier space in 3D, what is points, values, and xi? How big are they?
	\item Does interpolating with complex numbers cause any problems?
	\item Search through the code of some cryoEM software packages and find where they are doing interpolation. You could look for the forward model (simulating data) or for the interpolating of the 3D Fourier map before taking the inverse Fourier transform to get the map in real space. What are the dimensions? Can you tell if it is linear interpolation, or some other method?
\end{enumerate}

\subsection{18 March 2021 - Sharpen - Interpolation}
\textendash{Pre-reading}
\begin{enumerate}
	\item \href{https://www.paulinternet.nl/?page=bicubic}{Explanation and Java/C++ implementation of (bi)cubic interpolation}
	\item \url{https://en.wikipedia.org/wiki/Bicubic_interpolation}
	\item \href{https://web.archive.org/web/20051024202307/http://www.geovista.psu.edu/sites/geocomp99/Gc99/082/gc_082.htm}{Application of interpolation to elevation samples}
\end{enumerate}

\textendash {Questions}
\begin{enumerate} 
	\item Go through the \href{https://github.com/scipy/scipy/blob/v1.5.4/scipy/interpolate/interpnd.pyx}{source} of \href{https://docs.scipy.org/doc/scipy/reference/generated/scipy.interpolate.griddata.html}{scipy.interpolate.griddata} . What is the bottle neck for interpolation? You can try to read through the code, and also empirically benchmark things (e.g. sample a 2D or 3D Gaussian, which will give you real values, then compute the Gaussian function at these points, and interpolate on a cartesian grid at a specified granularity).
	\item Code up your own implementation of some sort of interpolation, that works in a similar way as \href{https://docs.scipy.org/doc/scipy/reference/generated/scipy.interpolate.griddata.html}{scipy.interpolate.griddata}, ie data point coordinates, data values (at those coordinates), and points at which to interpolate data. What is the bottle neck? How would you speed it up? 
	\item Investigate how sensitive \href{https://docs.scipy.org/doc/scipy/reference/generated/scipy.interpolate.griddata.html}{scipy.interpolate.griddata} is to noise, by sampling a function, corrupting it with noise, and seeing how smooth things have to be for the interpolation to work out well. Can you find a situation where there are pathologies? 
	\item How is \href{https://docs.scipy.org/doc/scipy/reference/generated/scipy.ndimage.map_coordinates.html#scipy.ndimage.map_coordinates}{scipy.ndimage.map\_coordinates} different from \href{https://docs.scipy.org/doc/scipy/reference/generated/scipy.interpolate.griddata.html}{scipy.interpolate.griddata}?
\end{enumerate}

\subsection{25 March 2021 - Blur - Guest lecture: Dr. David Dynerman, 3D Reconstruction via Direct Fourier Inversion.}
\href{https://www.linkedin.com/in/david-dynerman-6a4a47101/}{Dr. David Dynerman} is currently the Chief Scientific Officer at \href{https://www.thepublichealthco.com/}{The Public Health Company}. Prior to this he lectured on cryoEM at Berkeley, where he also worked with Eva Nogales (Molecular \& Cell Biology) and Bernd Sturmfels (Mathematics) to develop new algorithms for 2D $\rightarrow$ 3D reconstruction in cryo-electron microscopy. His lecture will explain direct Fourier inversion (2D $\rightarrow$ 3D reconstruction). \\ \\
\textendash{Audience} 
\\
This lecture will be structured so that beginners will (hopefully) learn some useful basics, while folks with more background will gain an orientation of the topic with road signs on where to dive in for more detail.
\\ \\
\textendash{Learning objectives}
\begin{enumerate}
  \item understand the basic principles of how direct Fourier inversion produces 3D reconstructions from 2D images
  \item understand the basics of two key technical aspects of Fourier inversion: Fourier interpolation and back projection
  \item understand what kinds of map artifacts can arise during direct Fourier inversion
\end{enumerate}
\textendash{Pre-reading}
\begin{enumerate}
	\item \href{https://youtu.be/INtehLmqfmA}{Part 2: 3-D Waves and Transforms - G. Jensen} (13 min)
	\item \href{https://youtu.be/_Ngybc0Rjo0}{Part 4: 3-D Reconstruction - G. Jensen} (11 min)
\end{enumerate}
\textendash {Questions}
\begin{enumerate}
	\item How could we visualize a single particle slice in a 3D map - either in real space or reciprocal space? How would this type of visualization help you? What other visualizations would be suitable?
	\item How does understanding Fourier interpolation and back projection help use data processing software, refine high quality maps, and solve structures?
	\item Do you think Fourier inversion will always be used in cryoEM data processing, or will other methods eventually replace it?
	\item What other research fields also use similar techniques (medical imaging, materials science, etc), and how much do practitioners in those fields understand about Fourier inversion?
	\item How much do you want/need to know about Fourier inversion, and what will help you build intuition?
\end{enumerate}
\textendash{Meeting Recording} \\
{\tiny \url{https://utoronto.zoom.us/rec/share/iUQlpdJvEwJ4Z-GU3bQjJzccyPSJg0iocKhN5RFwyHXMKkuIpR5I3alav3UKfk4T.hA7WqNfNCNPpbqN7}}

Access Passcode: 041\&NOnv+F

\end{document}  